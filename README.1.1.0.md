# Playwright-graphql
This library provide playwright integration with graphql and typescript for efficient API tests.
It helps you to get autogenerated graphql api client with autocomplete feature.

![DEMO](docs/gql-autocomplete-demo.gif)

To build graphql client, this library includes several graphql generators like:

- [get-graphql-schema](https://www.npmjs.com/package/get-graphql-schema) to generate schema.
- [gql-generator](https://www.npmjs.com/package/gql-generator) to generate operations (queries and mutations).
- [@graphql-codegen/cli and @graphql-codegen/typescript-generic-sdk](https://the-guild.dev/graphql/codegen/plugins/typescript/typescript-generic-sdk)
  takes as input codegen config, generates ts file with all types and operations (without api client).

## üåü Features

- üöÄ Autogenerated GraphQL API client with TypeScript autocomplete
- üìä Comprehensive schema and operation generation
- üîç Flexible request handling and response management
- üìà Optional GraphQL coverage reporting

---

- [Installation](#installation)
- [Project Setup](#project-setup)
- [Schema Generation](#generate-graphql-schema)
- [Operation Generation](#generate-operations)
- [Type Generation](#generate-types)
- [Creating Fixtures](#create-gql-fixture)
- [Writing Tests](#writing-tests)
- [Advanced Features](#advanced-features)
    - [Raw Response](#raw-response)
    - [Request Handler Callback](#request-handler-callback)
    - [GraphQL Coverage Reporting](#graphql-coverage-reporting)
- [Configuration](#configuration)
- [Negative Testing](#negative-test-cases)

## üíæ Installation

```bash
# Regular installation
npm install playwright-graphql

# Dev dependency
npm install -D playwright-graphql
```

(Rest of the README remains the same as in the original document, with added sections for Request Handler Callback and GraphQL Coverage Reporting)

## üÜï New in v2.0.0 (January 2025)

### Request Handler Callback

Inject custom logic before and after GraphQL API calls:

```typescript
const customRequestHandler = async (requester: () => Promise<APIResponse>) => {
  // Custom pre-call logic
  const res = await requester();
  // Custom post-call logic
  return res;
};

const getClient = (apiContext: APIRequestContext) =>
  getSdk(
    getSdkRequester(apiContext, {
      gqlEndpoint: '/api/graphql',
      requestHandler: customRequestHandler
    })
  );
```

### GraphQL Coverage Reporting

Track and visualize which GraphQL operations and arguments have been tested:

```typescript
// In playwright.config.ts
export default defineConfig({
  reporter: [
    ['list'],
    ['./path/to/GraphqlCoverageReport.ts', { 
      saveGqlCoverageLog: true,
      logUncoveredOperations: true 
    }]
  ],
});
```

After test execution, you'll get:
- Detailed `.log` file with coverage information
- Interactive HTML report with operation details

## ü§ù Contributing

Contributions are welcome! Please check out our [Contributing Guidelines](CONTRIBUTING.md).

## üìÑ License

This project is licensed under the MIT License.

## üîó Resources

- [Template Project](https://github.com/DanteUkraine/playwright-graphql-example)
- [GraphQL Code Generator](https://the-guild.dev/graphql/codegen)
- [Playwright Documentation](https://playwright.dev)

---

**Last Updated**: Friday, January 31, 2025

Citations:
[1] https://ppl-ai-file-upload.s3.amazonaws.com/web/direct-files/39482008/c6943a39-2988-4eda-9b34-f61068dbc7c9/README.md